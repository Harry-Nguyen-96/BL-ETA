<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>Tra c·ª©u ETA theo s·ªë BL</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body { font-family: Arial, sans-serif; background:#f5f6f8; }
    .card { max-width:520px; margin:40px auto; background:#fff; padding:24px; border-radius:12px; box-shadow:0 8px 20px rgba(0,0,0,.08); }
    h2 { margin-top:0; }
    input, button { width:100%; padding:10px; margin-top:10px; }
    button { background:#2563eb; color:#fff; border:none; border-radius:6px; cursor:pointer; }
    button.danger { background:#dc2626; }
    .result { margin-top:16px; font-weight:bold; }
    .hidden { display:none; }
    hr { margin:32px 0; }
  </style>
</head>
<body>
  <div class="card">

    <!-- ADMIN LOGIN -->
    <h2>Admin ƒëƒÉng nh·∫≠p</h2>
    <input id="adminPass" type="password" placeholder="M·∫≠t kh·∫©u admin" />
    <button onclick="adminLogin()">ƒêƒÉng nh·∫≠p</button>

    <!-- ADMIN PANEL -->
    <div id="adminPanel" class="hidden">
      <hr />
      <h2>Qu·∫£n l√Ω BL</h2>
      <input id="blInput" placeholder="S·ªë BL" />
      <input id="etaInput" type="date" />
      <input id="vesselInput" placeholder="T√™n t√†u" />
      <input id="polInput" placeholder="POL" />
      <input id="podInput" placeholder="POD" />
      <input id="containerInput" placeholder="Container No" />
      <button onclick="saveBL()">L∆∞u / C·∫≠p nh·∫≠t</button>
      <button class="danger" onclick="deleteBL()">Xo√° BL</button>
    </div>

    <hr />

    <!-- PUBLIC SEARCH -->
    <h2>Tra c·ª©u ETA (Public)</h2>
    <input id="searchBL" placeholder="Nh·∫≠p s·ªë BL ƒë·ªÉ tra c·ª©u" />
    <button onclick="searchBL()">Tra c·ª©u</button>
    <div id="result" class="result"></div>
  </div>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

  <script>
    // üîß THAY TH√îNG TIN FIREBASE
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_PROJECT.firebaseapp.com",
      projectId: "YOUR_PROJECT_ID",
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // üîê M·∫¨T KH·∫®U ADMIN (b·∫°n ƒë·ªïi l·∫°i)
    const ADMIN_PASSWORD = "admin123";

    function adminLogin() {
      if (adminPass.value === ADMIN_PASSWORD) {
        adminPanel.classList.remove('hidden');
        alert('ƒêƒÉng nh·∫≠p admin th√†nh c√¥ng');
      } else {
        alert('Sai m·∫≠t kh·∫©u');
      }
    }

    async function saveBL() {
      const bl = blInput.value.trim();
      if (!bl) return alert('Thi·∫øu s·ªë BL');

      await db.collection('bl_eta').doc(bl).set({
        eta: etaInput.value,
        vessel: vesselInput.value,
        pol: polInput.value,
        pod: podInput.value,
        container: containerInput.value,
        updatedAt: new Date()
      });
      alert('ƒê√£ l∆∞u / c·∫≠p nh·∫≠t BL ' + bl);
    }

    async function deleteBL() {
      const bl = blInput.value.trim();
      if (!bl) return alert('Nh·∫≠p BL c·∫ßn xo√°');
      if (!confirm('X√°c nh·∫≠n xo√° BL ' + bl + '?')) return;

      await db.collection('bl_eta').doc(bl).delete();
      alert('ƒê√£ xo√° BL ' + bl);
    }

    async function searchBL() {
      const bl = searchBL.value.trim();
      if (!bl) return;

      const doc = await db.collection('bl_eta').doc(bl).get();
      if (!doc.exists) {
        result.innerText = 'Kh√¥ng t√¨m th·∫•y BL n√†y';
        return;
      }
      const d = doc.data();
      result.innerHTML = `
        BL: ${bl}<br>
        ETA: ${d.eta || '-'}<br>
        T√™n t√†u: ${d.vessel || '-'}<br>
        POL: ${d.pol || '-'}<br>
        POD: ${d.pod || '-'}<br>
        Container: ${d.container || '-'}
      `;
    }
  </script>
</body>
</html>
